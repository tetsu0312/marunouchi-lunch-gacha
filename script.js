// ==============================
// çŠ¶æ…‹ç®¡ç†ç”¨ã®å¤‰æ•°
// ==============================

// ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å¾Œã€çµæœè¡¨ç¤ºå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ã‚¿ãƒ¼ãƒ³
const spinningMessages = [
  "ã‚¬ãƒãƒ£å›ã—ä¸­â€¦ğŸ˜‹",
  "ä»Šæ—¥ã®ãƒ©ãƒ³ãƒã‚’é¸ã³ã‚ˆã‚‹ã‚ˆã€œğŸ´",
  "ãŠè…¹ã™ã„ã¦ããŸã°ã„â€¦ğŸ¤¤",
  "ã†ã¾ã‹åº—ã‚’æ¢ã—ã‚ˆã‚‹ã‘ã‚“ã­ğŸ‘€",
  "ä»Šæ—¥ã¯ã“ã“ã‹ã‚‚â€¦ï¼ŸğŸ¤”",
  "ãƒ©ãƒ³ãƒã®é‹å‘½ã€å›è»¢ä¸­ğŸ°",
  "ä¸¸ã®å†…ãƒ©ãƒ³ãƒä¼šè­°ä¸­ğŸ“",
  "èƒƒè¢‹ã¨ç›¸è«‡ã—ã‚ˆã‚‹â€¦ğŸ˜†",
  "è¿·ã„ã«è¿·ã£ã¨ã‚‹ã°ã„â€¦ğŸŒ€",
  "ãˆãˆåº—å¼•ãäºˆæ„Ÿã—ã‹ã—ãªã„âœ¨",

  "ä»Šæ—¥ã®ãƒ©ãƒ³ãƒã€æ¥½ã—ã¿ãƒ¼ï¼ğŸ˜†ğŸ½ï¸",
  "ãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¦ããŸã°ã„ã€œğŸ’“",
  "ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ããŸãƒ¼ãƒ¼ï¼ğŸ‰",
  "ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸ŠãŒã£ã¦ããŸãƒ¼ï¼ğŸ”¥",
  "ä»Šæ—¥ã¯å½“ãŸã‚Šãã†ãªæ°—ãŒã™ã‚‹ğŸ˜‹âœ¨",
  "ãŠæ˜¼ã®æ™‚é–“ã£ã¦æœ€é«˜ã‚ˆã­ğŸ¥°",
  "ä½•ãŒå‡ºã‚‹ã‹ãƒ‰ã‚­ãƒ‰ã‚­â€¦ğŸ˜³",
  "ãƒ©ãƒ³ãƒã®ã“ã¨è€ƒãˆã‚‹ã ã‘ã§å¹¸ã›ğŸ€",
  "ã‚‚ã†ã™ãæ±ºã¾ã‚‹ã¨æ€ã†ã¨æ¥½ã—ã‹ã€œğŸ˜†",
  "æœŸå¾…ãŒã©ã‚“ã©ã‚“é«˜ã¾ã£ã¨ã‚‹âœ¨",

  "ä»Šæ—¥ã‚‚ã„ã„ãƒ©ãƒ³ãƒã«ãªã‚Šãã†ã°ã„ğŸ´âœ¨",
  "ãŠè…¹ãŒå–œã¶æº–å‚™ã—ã¨ã‚‹ğŸ¤¤",
  "ãƒ©ãƒ³ãƒã®æ™‚é–“ã£ã¦ãªã‚“ã§ã“ã‚“ãªæ¥½ã—ã„ã‚“ã‚„ã‚ğŸ˜†",
  "ã†ã¾ã‹ã‚‚ã‚“å‡ºã¦ãã¦ã»ã—ã‹ã€œğŸ™",
  "ä»Šæ—¥ã®ãƒ©ãƒ³ãƒã€å½“ãŸã‚Šã§ã‚ã‚Œï¼ğŸ¯âœ¨",
  "èƒƒè¢‹ãŒãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¨ã‚‹ã°ã„ğŸ˜‹",
  "ãã‚ãã‚ãƒ†ãƒ³ã‚·ãƒ§ãƒ³MAXğŸ”¥",
  "ãŠæ˜¼ã®ã”è¤’ç¾ã‚¿ã‚¤ãƒ åˆ°æ¥ğŸ",
  "ãƒ©ãƒ³ãƒã‚¬ãƒãƒ£ã€æœ€é«˜ã®ç¬é–“ã°ã„ğŸ˜†",
  "ã‚‚ã†å¾…ã¦ã‚“ï¼æ—©ãçŸ¥ã‚ŠãŸã„ã€œğŸ˜‚",

  "ãƒ©ãƒ³ãƒã®ç¥æ§˜ã€é ¼ã‚“ã ã°ã„ğŸ™ğŸ´",
  "ä»Šæ—¥ã®ãƒ©ãƒ³ãƒã€æ¥½ã—ã¿ã™ãã‚‹ï¼ğŸ˜†ğŸ’“",
  "ãƒ¯ã‚¯ãƒ¯ã‚¯ãŒæ­¢ã¾ã‚‰ã‚“ã€œï¼ğŸ‰",
  "ãã‚ãã‚é‹å‘½æ±ºã¾ã‚Šãã†â€¦ğŸ‘€",
  "ãƒ‰ã‚­ãƒ‰ã‚­æœ€é«˜æ½®ã°ã„ğŸ’“",
  "ä»Šæ—¥ã®ãŠæ˜¼ã€çµ¶å¯¾ã„ã„æ—¥ã«ãªã‚‹âœ¨",
  "ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ã£ã¦å¹¸ã›ã®å¡Šã‚ˆã­ğŸ˜‹",
  "ã‚‚ã†ã™ãçµæœå‡ºã‚‹ã‘ã‚“å¾…ã£ã¦ã­ã€œğŸ¾",
  "ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã¶ã¡ä¸ŠãŒã‚Šä¸­ğŸš€ğŸ”¥",
  "ã•ãã•ãâ€¦çµæœç™ºè¡¨ã„ãã°ã„ï¼ğŸŠğŸ´",

  "æ¥½ã—ã¿ã™ãã¦ãƒ‹ãƒ¤ãƒ‹ãƒ¤ã—ã¨ã‚‹ğŸ˜†",
  "ãŠæ˜¼ã®ãƒ¯ã‚¯ãƒ¯ã‚¯ã€æ­¢ã¾ã‚‰ã‚“ã°ã„ğŸ’“",
  "ä»Šæ—¥ã¯çµ¶å¯¾ã†ã¾ã‹æ—¥ãŸã„ï¼ğŸ˜‹âœ¨",
  "ãƒ©ãƒ³ãƒã®æ™‚é–“ããŸã ã‘ã§å¬‰ã—ã‹ã€œğŸ¶",
  "ä½•ãŒå‡ºã¦ã‚‚æ¥½ã—ã‚ãã†ğŸ˜†ğŸ´",
  "ã‚‚ã†ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸ŠãŒã‚Šã£ã±ãªã—ğŸ”¥",
  "ãƒ©ãƒ³ãƒè€ƒãˆã‚‹ã¨å…ƒæ°—å‡ºã‚‹ã­ğŸ’ªâœ¨",
  "ãŠè…¹ã‚‚å¿ƒã‚‚æº–å‚™OKã°ã„ğŸ™Œ",
  "ãƒ¯ã‚¯ãƒ¯ã‚¯åº¦ã€é™ç•Œçªç ´ä¸­ğŸ˜†",
  "ä»Šæ—¥ã¯ã„ã„äºˆæ„Ÿã—ã‹ã—ãªã„âœ¨",

  "ãƒ©ãƒ³ãƒã®ã“ã¨è€ƒãˆãŸã‚‰ç¬‘é¡”ãªã‚‹ğŸ˜Š",
  "ãŠæ˜¼ãŒæ¥½ã—ã¿ã§ä»•äº‹é ‘å¼µã‚ŒãŸã°ã„ğŸ’¼ğŸ”¥",
  "ã•ãã©ã“è¡Œãã‚“ã‚„ã‚ã€œğŸ˜†",
  "ã†ã¾ã‹ãƒ©ãƒ³ãƒæ¥ã„æ¥ã„ï¼ğŸ´âœ¨",
  "ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ä¸Šã’ã¦ã„ã“ã€œğŸ‰",
  "ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ã¯æ­£ç¾©ãŸã„ğŸ˜‹",
  "ãƒ¯ã‚¯ãƒ¯ã‚¯ãŒæŠ‘ãˆãã‚Œã‚“ã°ã„ğŸ’“",
  "ä»Šæ—¥ã¯è‡ªåˆ†ã«ã”è¤’ç¾ãƒ©ãƒ³ãƒã‹ã‚‚ğŸ˜†",
  "ãŠæ˜¼ã®å¹¸ã›ã€ã‚‚ã†ã™ãã‚„ã­ğŸ€",
  "ãƒ‰ã‚­ãƒ‰ã‚­ã—ãªãŒã‚‰å¾…ã£ã¨ã“ğŸ˜³âœ¨"
];

// ã‚¬ãƒãƒ£ãŒå›è»¢ä¸­ã‹ã©ã†ã‹ã‚’ç®¡ç†ã™ã‚‹ãƒ•ãƒ©ã‚°
let isSpinning = false;

// JSONã‹ã‚‰èª­ã¿è¾¼ã‚“ã ãƒ©ãƒ³ãƒä¸€è¦§ã‚’å…¥ã‚Œã‚‹é…åˆ—
let lunchList = [];

// å‰å›é¸ã°ã‚ŒãŸåº—èˆ—ã‚’ä¿æŒ
let lastShop = null;

// ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ã®DOMè¦ç´ ã‚’å–å¾—
const button = document.getElementById("gachaBtn");

// çµæœã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨
const result = document.getElementById("result");

// ==============================
// ãƒ©ãƒ³ãƒãƒ‡ãƒ¼ã‚¿ï¼ˆJSONï¼‰ã‚’èª­ã¿è¾¼ã‚€
// ==============================

// lunch_list.json ã‚’å–å¾—ã—ã¦ JavaScript ã§ä½¿ãˆã‚‹å½¢ã«å¤‰æ›
fetch("lunch_list.json")
  .then(response => response.json())
  .then(data => {
    // JSONã®ä¸­èº«ã‚’ lunchList ã«ä¿å­˜
    lunchList = data;
  });

// ==============================
// ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸæ™‚ã®å‡¦ç†
// ==============================

button.addEventListener("click", () => {
  // ã‚¬ãƒãƒ£å›è»¢ä¸­ãªã‚‰ä½•ã‚‚ã—ãªã„ï¼ˆé€£æ‰“é˜²æ­¢ï¼‰
  if (isSpinning) return;

  // ãƒ‡ãƒ¼ã‚¿ãŒã¾ã èª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã‘ã‚Œã°ä¸­æ–­
  if (lunchList.length === 0) return;

  // ã‚¬ãƒãƒ£å›è»¢é–‹å§‹
  isSpinning = true;
  button.disabled = true;

  // ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å¾Œã€çµæœè¡¨ç¤ºå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
const message =
  spinningMessages[Math.floor(Math.random() * spinningMessages.length)];

document.getElementById("shop").textContent = message;
document.getElementById("comment").textContent = "";
  // åˆå›ã§ã‚‚è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹
result.classList.add("show");

  // å°‘ã—å¾…ã£ã¦ã‹ã‚‰çµæœã‚’è¡¨ç¤ºï¼ˆã‚¬ãƒãƒ£æ¼”å‡ºï¼‰
  setTimeout(() => {
  let shop;

  // å‰å›ã¨åŒã˜åº—ã«ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹
  do {
    shop = lunchList[Math.floor(Math.random() * lunchList.length)];
  } while (shop.name === lastShop);

  const comment =
    shop.comments[Math.floor(Math.random() * shop.comments.length)];

  document.getElementById("shop").textContent = shop.name;
  document.getElementById("comment").textContent = comment;

  // çµæœãµã‚ã£ã¨è¡¨ç¤º
  result.classList.add("show");

  // ãƒœã‚¿ãƒ³ã·ã‚‹ã·ã‚‹åœæ­¢
  button.classList.remove("spinning");

  // ä»Šå›ã®åº—ã‚’ä¿å­˜
  lastShop = shop.name;

  isSpinning = false;
  button.disabled = false;
}, 1500); // 1.5ç§’å¾…ã¤
});
